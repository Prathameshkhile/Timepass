<!DOCTYPE html>
<html>
<head><title>Receiver</title></head>
<body>
<h2>Receiver</h2>
<textarea id="offer" placeholder="Paste Offer Here" cols="60" rows="10"></textarea><br>
<textarea id="answer" placeholder="Answer will appear here" cols="60" rows="10"></textarea><br>
<button onclick="start()">Receive File</button>
<script>
let pc = new RTCPeerConnection({
  iceServers: [
    { urls: "stun:stun.l.google.com:19302" }
  ]
});


pc.ondatachannel = (event) => {
    const channel = event.channel;
    channel.onmessage = (e) => {
        const blob = new Blob([e.data]);
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "received_file";
        a.click();
        alert("File received!");
    };
};

async function start() {
    const offer = JSON.parse(document.getElementById("offer").value);
    await pc.setRemoteDescription(offer);
    const answer = await pc.createAnswer();
    await pc.setLocalDescription(answer);
    document.getElementById("answer").value = JSON.stringify(pc.localDescription);
}
</script>
</body>
</html>
